<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="mj.utils">
	<head>
		<metal:block metal:fill-slot="head_slot">
			<link class="include" rel="stylesheet" type="text/css" tal:attributes="href string:${view/site_url}/++resource++css/jquery.jqplot.min.css"/>
			<link class="include" rel="stylesheet" type="text/css" tal:attributes="href string:${view/site_url}/++resource++css/sinesp.css"/>

		</metal:block>
		<metal:block metal:fill-slot="javascript_head_slot">
			<script tal:attributes="src string:${view/site_url}/++resource++js/Chart.js" type="text/javascript"></script>
			<script class="include" type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
			<script tal:attributes="src string:${view/site_url}/++resource++js/jquery.jqplot.min.js" type="text/javascript"></script>
		</metal:block>
	</head>
    <body>
        <metal:content-core fill-slot="main">
            <metal:block define-macro="main">
				<div id="conteudo-interno"
					class="span-64 prepend-1 append-1 last"
					tal:define="tipo_request python: context.REQUEST.get('tipo', None);">
					<h1 class="documentFirstHeading">Estatísticas Criminais</h1>
					<div class="form_estatistica">
					<form method="POST"
						name="estatisticas-publicas-sinesp"
						id="estatisticas-publicas-sinesp"
						tal:attributes="action string:${context/absolute_url}/estatisticas-publicas-sinesp"
						enctype="multipart/form-data"
						tal:define="errors view/errors;">

						
						<div tal:define="error errors/tipo | nothing;"
							tal:attributes="class python:'field error' if error else 'field'">
							<label for="tipo_crime" i18n:translate="">Selecione o Relatório:</label>
							<div tal:condition="error" tal:content="error" />
							<select id="tipo" name="tipo">
								<option value="">- - - - - - - - - - - - - - - - -</option>
								<tal:block condition="tipo_request">
									<tal:block repeat="tipo view/getTipo">
										<option tal:attributes="value tipo;
										                        selected python: tipo == tipo_request;" tal:content="tipo"></option>
									</tal:block>
								</tal:block>
								<tal:block condition="not:tipo_request">
									<tal:block repeat="tipo view/getTipo">
										<option tal:attributes="value tipo" tal:content="tipo"></option>
									</tal:block>
								</tal:block>
							</select>
						</div>
						<input type="submit" name="form.execute" value="Exibir" />
						<br/>
					</form>
					</div>
					<div class="texto_estatistica">
						<p>As estatísticas criminais são utilizadas para retratar a situação da segurança pública e permitir o planejamento de ações policiais e de investimentos no setor. A compilação dos dados é realizada pela Secretaria Nacional de Segurança Pública - SENASP por intermédio do módulo de estatísticas do Sistema Nacional de Informações de Segurança Pública, Prisionais e sobre Drogas - SINESP. O sistema é alimentado pelos órgãos de Segurança Pública das Unidades de Federação desde 2004. O SINESP tem como objetivo padronizar e organizar o fluxo dos dados criminais junto as polícias, a partir dos procedimentos de registro das ocorrências criminais. Até 2012, as estatísticas criminais eram geradas somente com dados dos municípios com população superior a 100 mil habitantes, a partir de janeiro de 2013, já é possível o tratamento e análise de dados de todos os municípios brasileiros, permitindo, assim, retratar o Brasil de forma mais detalhada. Isto e outras muitas conquistas só foram possíveis através da assinatura de um termo de adesão ao SINESP realizada pela União com os Estados e o Distrito Federal, tornando efetivo o apoio dos participantes no que tange o cumprimento da lei 12.681 de 04 julho de 2012, que instituiu o SINESP.</p>
						<p>Nota: Os dados apresentados nos relatórios correspondem à extração do dia 04/03/2016</p>

					</div>

					<div style="clear:both;" />
					
					<br/>

					<div>
						 
					<h2>Relatório Consolidado de Ocorrências de estupros registrados pela Polícia Civil</h2>
					<p>
						Relatório com tabelas, mapa e gráfico com informações da soma de todos os casos de estupro (constranger alguém, mediante violência ou grave ameaça, a ter conjunção carnal ou a praticar ou permitir que com ele se pratique outro ato libidinoso) e suas respectivas taxas por 100 mil habitantes, por ano, Unidades da Federação e Brasil.

					</p>

					</div>


					<tal:block define="dados view/dados;
									  frotas python:['Furto de Veiculo', 'Roubo de Veículo'];" condition="dados">

					<div class="box_graficos">							  
						<h3>
							Evolução da taxa de <span tal:replace="python: tipo_request.lower()"/> por 100 mil
							<tal:block condition="python: not(tipo_request in frotas)">
								habitantes
							</tal:block>
							<tal:block condition="python: tipo_request in frotas">
								veículos
							</tal:block>
							<tal:block define="anos view/anos" condition="python:len(anos)>1">
								entre <span tal:replace="python:anos[0]"/> e <span tal:replace="python:anos[-1]"/>.
							</tal:block>
						</h3>
						<div style="width: 900px" >
							<div class="vertical">
								<tal:block condition="python: not(tipo_request in frotas)">
									<p>Taxa por 100 mil habitantes</p>
								</tal:block>
								<tal:block condition="python: tipo_request in frotas">
									<p>Taxa por 100 mil veículos</p>
								</tal:block>
							</div>
							<div style="margin-left:38px;">
        						<div id="chart1" style="margin-top:20px; margin-left:20px; width:400px; height:300px;"></div>
							</div>
						</div>
					</div>
						<tal:script replace="structure string:&lt;script type='text/javascript'&gt;" />
							$(document).ready(function(){
								var s1 = <span tal:replace="view/grafico"/>;
								var grid = {
									gridLineWidth: 1.5,
									gridLineColor: 'rgb(235,235,235)',
									drawGridlines: true
								};

								plot1 = $.jqplot('chart1', [s1], {
									series:[{
										renderer:$.jqplot.BarRenderer,
										rendererOptions: {
											barWidth: 30
										}
									}],
									axes: {
										xaxis: {
											renderer: $.jqplot.CategoryAxisRenderer
										}
									},
									grid: grid,
									canvasOverlay: {
										show: true,
										objects: [
											{horizontalLine: {
												name: 'barney',
												y: 4,
												lineWidth: 6,
												color: 'rgb(100, 55, 124)',
												shadow: false
											}},
											{horizontalLine: {
												name: 'fred',
												y: 6,
												lineWidth: 12,
												xminOffset: '8px',
												xmaxOffset: '29px',
												color: 'rgb(50, 55, 30)',
												shadow: false
											}},
											{dashedHorizontalLine: {
												name: 'wilma',
												y: 8,
												lineWidth: 2,
												xOffset: '54',
												color: 'rgb(133, 120, 24)',
												shadow: false
											}},
											{horizontalLine: {
												name: 'pebbles',
												y: 10,
												lineWidth: 3,
												xOffset: 0,
												color: 'rgb(89, 198, 154)',
												shadow: false
											}},
											{dashedHorizontalLine: {
												name: 'bam-bam',
												y: 14,
												lineWidth: 5,
												dashPattern: [16, 12],
												lineCap: 'round',
												xOffset: '20',
												color: 'rgb(66, 98, 144)',
												shadow: false
											}}
										]
									}
								});
							});
							function lineup() {
								var co = plot1.plugins.canvasOverlay;
								var line = co.get('fred');
								line.options.y += 1;
								co.draw(plot1);
							}

							function linedown() {
								var co = plot1.plugins.canvasOverlay;
								var line = co.get('fred');
								line.options.y -= 1;
								co.draw(plot1);
							}
						<tal:script replace="structure string:&lt;/script&gt;" />

						<div class="box_graficos">
							<h3>
								Número de registros de ocorrências de <span tal:replace="python: tipo_request.lower()"/> e taxa por 100 mil
								<tal:block condition="python: not(tipo_request in frotas)">
									habitantes
								</tal:block>
								<tal:block condition="python: tipo_request in frotas">
									veículos
								</tal:block>
								<tal:block define="anos view/anos" condition="python:len(anos)>1">
									referente aos anos de <span tal:replace="python:anos[0]"/> a <span tal:replace="python:anos[-1]"/>.
								</tal:block>
							</h3>
							<table id="listing-table" class="listing">
								<thead>
									<tr>
										<th rowspan="2" style="text-align: center;">
											UF	
										</th>
										<tal:block repeat="ano view/anos">
											<th colspan="2" style="text-align: center;">
												<span tal:content="ano"/>
											</th>
										</tal:block>
									</tr>
									<tr >
										<tal:block repeat="ano view/anos">
											<th style="text-align: center;">
												Registros de <br/>Ocorrências
											</th>
											<tal:block condition="python: not(tipo_request in frotas)">
												<th style="text-align: center;">
													Taxa por 100 <br/>mil hab.
												</th>
											</tal:block>
											<tal:block condition="python: tipo_request in frotas">
												<th style="text-align: center;">
													Taxa por 100 <br/>mil veic.
												</th>
											</tal:block>
										</tal:block>
									</tr>
								</thead>
								<tfoot>
									<tr>
										<th>
											Total
										</th>
										<tal:block repeat="ano view/anos">
											<tal:block tal:define="total python:view.getTotal(ano)">
												<th style="text-align: right;">
													<span tal:replace="total/total_registro"/>
												</th>
												<th style="text-align: right;">
													<span tal:replace="python: total['total_taxa'].replace('.', ',')"/>
												</th>
											</tal:block>
										</tal:block>
									</tr>
								</tfoot>
								<tbody>
									<tal:block repeat="uf view/uf">
										<tr>
											<td style="text-align: center;">
												<span tal:content="uf"/>
											</td>
											<tal:block repeat="ano view/anos">
												<tal:block define="item python: view.getItem(uf, ano);">
													<td style="text-align: right;">
														<span tal:content="item/qtd_ocorrencias"/>
													</td>
													<td style="text-align: right;">
														<span tal:content="python: item['taxa'].replace('.', ',')"/>
													</td>
												</tal:block>
											</tal:block>
										</tr>
									</tal:block>
								</tbody>
							</table>

						</div>
						<div class="box_graficos">
							<h3>
								Número de ocorrências de <span tal:replace="python: tipo_request.lower()"/>, taxa por 100 mil
								<tal:block condition="python: not(tipo_request in frotas)">
									habitantes
								</tal:block>
								<tal:block condition="python: tipo_request in frotas">
									veículos
								</tal:block>
								e população por Unidade da Federação em
								<tal:block define="anos view/anos" condition="python:len(anos)>0">
									<span tal:replace="python:anos[-1]"/>.
								</tal:block>
							</h3>
							<table id="listing-table" class="listing">
								<thead>
									<tr>
										<th style="text-align: center;">
											Unidade da Federação
										</th>
										<th style="text-align: center;">
											Registros de Ocorrências
										</th>
										<th style="text-align: center;">
											<tal:block condition="python: not(tipo_request in frotas)">
												Taxa por 100 mil hab.
											</tal:block>
											<tal:block condition="python: tipo_request in frotas">
												Taxa por 100 mil veic.
											</tal:block>
										</th>
										<th style="text-align: center;">
											<tal:block condition="python: not(tipo_request in frotas)">
												População
											</tal:block>
											<tal:block condition="python: tipo_request in frotas">
												Frota de Veículos
											</tal:block>
										</th>
									</tr>
								</thead>
								<tal:block define="anos view/anos" condition="python:len(anos)>0">
									<tal:block tal:define="ano python:anos[-1];
														total python:view.getTotal(ano);">
										<tfoot>
											<tr>
												<th>
													Total
												</th>
												<th style="text-align:right;">
													<span tal:replace="total/total_registro"/>
												</th>
												<th style="text-align:right;">
													<span tal:replace="total/total_taxa"/>
												</th>
												<th style="text-align:right;">
													<span tal:replace="total/total_universo"/>
												</th>
											</tr>
										</tfoot>
									</tal:block>
								</tal:block>
								<tbody tal:define="ocorrencias view/getNumOcorrencia">
									<tal:block repeat="item ocorrencias">
										<tr>
											<td>
												<span tal:content="item/uf"/>
											</td>
											<td style="text-align:right;">
												<span tal:content="item/qtd_ocorrencias"/>
											</td>
											<td style="text-align:right;">
												<span tal:content="item/taxa"/>
											</td>
											<td style="text-align:right;">
												<span tal:content="item/universo"/>
											</td>
										</tr>
									</tal:block>
								</tbody>
							</table>
						</div>	
					</tal:block>
				</div>
            </metal:block>
        </metal:content-core>
    </body>
</html>